
using UnityEngine;
using GLTFast;
using System.Threading.Tasks;

public class RuntimeGltfLoader : MonoBehaviour
{
    // This method loads a GLTF/GLB file from a local path and attaches it to a parent
    public async Task<GameObject> LoadGltf(string localPath, Transform parent)
    {
        // Add "file://" prefix for local files
        var uri = "file://" + localPath;

        // Create a glTF importer
        var gltf = new GltfImport();

        // Load the file
        var success = await gltf.Load(uri);
        if (!success)
        {
            Debug.LogError("GLTF load failed: " + localPath);
            return null;
        }

        // Create a root GameObject for the model
        var root = new GameObject("CAD_Runtime");
        await gltf.InstantiateMainSceneAsync(root.transform);

        // Attach to parent (e.g., AR model parent)
        root.transform.SetParent(parent, false);

        return root;
    }
}
